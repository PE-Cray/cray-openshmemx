<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>shmem_atomic_compare_swap</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body><h1><a href="../main.html">Index</a></h1>
<h1 id="summary">Summary</h1>
<pre><code>Performs an atomic conditional swap on a remote data object.</code></pre>
<h1 id="definitions">Definitions</h1>
<h2 id="c11-synopsis">C11 Synopsis</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ex">TYPE</span> shmem_atomic_compare_swap(TYPE *dest, TYPE cond, TYPE value, int pe);</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="ex">TYPE</span> shmem_atomic_compare_swap(shmem_ctx_t ctx, TYPE *dest, TYPE cond, TYPE value, int pe);</a></code></pre></div>
<p>where TYPE is one of the standard AMO types specified by Table:1</p>
<h2 id="cc-synopsis">C/C++ Synopsis</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="ex">TYPE</span> shmem_TYPENAME_atomic_compare_swap(TYPE *dest, TYPE cond, TYPE value, int pe);</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ex">TYPE</span> shmem_ctx_TYPENAME_atomic_compare_swap(shmem_ctx_t ctx, TYPE *dest,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                                            <span class="ex">TYPE</span> cond, TYPE value, int pe);</a></code></pre></div>
<p>where TYPE is one of the standard AMO types and has a corresponding TYPENAME specified by Table:1</p>
<h1 id="deprecated-synopsis">Deprecated Synopsis</h1>
<h2 id="deprecated-c11-synopsis">Deprecated C11 Synopsis</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ex">TYPE</span> shmem_cswap(TYPE *dest, TYPE cond, TYPE value, int pe);</a></code></pre></div>
<p>where TYPE is one of <code>int</code>, <code>long</code>, <code>long long</code>.</p>
<h2 id="deprecated-cc-synopsis">Deprecated C/C++ Synopsis</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">TYPE</span> shmem_TYPENAME_cswap(TYPE *dest, TYPE cond, TYPE value, int pe);</a></code></pre></div>
<p>where TYPE is one of <code>int</code>, <code>long</code>, <code>long long</code> and has a corresponding TYPENAME specified by Table:1 \end{DeprecateBlock}</p>
<h2 id="deprecated-fortran-synopsis">Deprecated Fortran Synopsis</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">INTEGER</span> pe</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="ex">INTEGER*4</span> SHMEM_INT4_CSWAP,  cond_i4, value_i4, ires_i4</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="ex">ires_i4</span> = SHMEM_INT4_CSWAP(dest, cond_i4, value_i4, pe)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="ex">INTEGER*8</span> SHMEM_INT8_CSWAP,  cond_i8, value_i8, ires_i8</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="ex">ires_i8</span> = SHMEM_INT8_CSWAP(dest, cond_i8, value_i8, pe)</a></code></pre></div>
<h1 id="datatype-reference-table">Datatype Reference Table</h1>
<h2 id="table1">Table:1</h2>
<pre><code>  |           TYPE          |      TYPENAME       |
  |-------------------------|---------------------|
  |   int                   |     int             |
  |   long                  |     long            |
  |   long long             |     longlong        |
  |   unsigned int          |     uint            |
  |   unsigned long         |     ulong           |
  |   unsigned long long    |     ulonglong       |
  |   int32_t               |     int32           |
  |   int64_t               |     int64           |
  |   uint32_t              |     uint32          |
  |   uint64_t              |     uint64          |
  |   size_t                |     size            |
  |   ptrdiff_t             |     ptrdiff         |</code></pre>
<h1 id="arguments">Arguments</h1>
<pre><code>ctx     The context on which to perform the operation. When this argument is
        not provided, the operation is performed on SHMEM_CTX_DEFAULT.
dest    The remotely accessible integer data object to be updated  on the
        remote PE.
cond    cond is compared to the remote dest value. If cond and the remote
        dest are equal, then value is swapped into the remote dest; otherwise,
        the remote dest is unchanged.  In either case, the old value of the
        remote dest is returned as the routine return value. cond must be of
        the same data type as dest.
value   The value to be atomically written to the remote PE. value must be
        the same data type as dest.
pe      An integer that indicates the PE number upon which dest is to be
        updated. When using Fortran, it must be a default integer value.</code></pre>
<h1 id="description">Description</h1>
<pre><code>The conditional swap routines conditionally update a dest data object on
the specified PE and return the prior contents of the data object in one
atomic operation.

When using Fortran, dest and value must be of the following type:
|     Routine      |Data type of dest and source|
|------------------|----------------------------|
| SHMEM_INT4_CSWAP |      4-byte integer        |
| SHMEM_INT8_CSWAP |      8-byte integer        |</code></pre>
<h1 id="return-values">Return Values</h1>
<pre><code>The contents that had been in the dest data object on the remote
PE prior to the conditional swap. Data type is the same as the
dest data type.</code></pre>
<h1 id="notes">Notes</h1>
<pre><code>None.</code></pre>
<h1 id="examples">Examples</h1>
<h2 id="cc-example">C/C++ Example</h2>
<pre><code>The following call ensures that the first PE to execute the
conditional swap will successfully write its PE number to
race_winner on PE 0.</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#include &lt;stdio.h&gt;</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#include &lt;shmem.h&gt;</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="ex">int</span> main(void)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">{</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">   <span class="ex">static</span> int race_winner = -1<span class="kw">;</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">   <span class="fu">shmem_init()</span>;</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">   <span class="ex">int</span> me = shmem_my_pe();</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">   <span class="ex">int</span> oldval = shmem_atomic_compare_swap(<span class="kw">&amp;</span><span class="ex">race_winner</span>, -1, me, 0);</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">   <span class="kw">if</span> <span class="kw">(</span><span class="ex">oldval</span> == -1<span class="kw">)</span> <span class="bu">printf</span>(<span class="st">&quot;PE %d was first\n&quot;</span>, me);</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">   <span class="fu">shmem_finalize()</span>;</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">   <span class="bu">return</span> 0<span class="kw">;</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="kw">}</span></a></code></pre></div>
<h1><a href="../main.html">Index</a></h1></body>
</html>
