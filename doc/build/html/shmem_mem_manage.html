

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Managing Memory in Cray OpenSHMEMX &mdash; Cray OpenSHMEMX 10.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Multithreading in Cray OpenSHMEMX" href="shmem_multithreading.html" />
    <link rel="prev" title="Overview" href="intro_shmem.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Cray OpenSHMEMX
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#openshmem-compliance">OpenSHMEM Compliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#different-available-transport-layers">Different Available Transport Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#whitepapers">Whitepapers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#openshmem-c11-generic-interfaces">OpenSHMEM C11-Generic Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#compiling-and-launching-a-shmem-application-on-a-cray-system">Compiling and Launching a SHMEM Application on a Cray System</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#general-notes">General Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_shmem.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Managing Memory in Cray OpenSHMEMX</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_multithreading.html">Multithreading in Cray OpenSHMEMX</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_addr_accessible.html">shmem_addr_accessible</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_init.html">shmem_init</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_init_thread.html">shmem_init_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_finalize.html">shmem_finalize</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_global_exit.html">shmem_global_exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_my_pe.html">shmem_my_pe</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_n_pes.html">shmem_n_pes</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_info_get_name.html">shmem_info_get_name</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_info_get_version.html">shmem_info_get_version</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_pe_accessible.html">shmem_pe_accessible</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_query_thread.html">shmem_query_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_malloc.html">shmem_malloc</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_calloc.html">shmem_calloc</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_ptr.html">shmem_ptr</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_ctx_create.html">shmem_ctx_create</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_ctx_destroy.html">shmem_ctx_destroy</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_p.html">shmem_p</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_put.html">shmem_put</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_put_nbi.html">shmem_put_nbi</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_iput.html">shmem_iput</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_g.html">shmem_g</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_get.html">shmem_get</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_get_nbi.html">shmem_get_nbi</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_iget.html">shmem_iget</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_add.html">shmem_atomic_add</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_and.html">shmem_atomic_and</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_compare_swap.html">shmem_atomic_compare_swap</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch.html">shmem_atomic_fetch</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch_add.html">shmem_atomic_fetch_add</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch_and.html">shmem_atomic_fetch_and</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch_inc.html">shmem_atomic_fetch_inc</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch_or.html">shmem_atomic_fetch_or</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_fetch_xor.html">shmem_atomic_fetch_xor</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_inc.html">shmem_atomic_inc</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_or.html">shmem_atomic_or</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_set.html">shmem_atomic_set</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_swap.html">shmem_atomic_swap</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_atomic_xor.html">shmem_atomic_xor</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_fence.html">shmem_fence</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_quiet.html">shmem_quiet</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_test.html">shmem_test</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_wait_until.html">shmem_wait_until</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_lock.html">shmem_lock</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_alltoall.html">shmem_alltoall</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_alltoalls.html">shmem_alltoalls</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_barrier.html">shmem_barrier</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_barrier_all.html">shmem_barrier_all</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_broadcast.html">shmem_broadcast</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_collect.html">shmem_collect</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_reductions.html">shmem_reductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_sync.html">shmem_sync</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_sync_all.html">shmem_sync_all</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmem_cache.html">shmem_cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_init_thread.html">shmemx_init_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_kind_align.html">shmemx_kind_align</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_kind_malloc.html">shmemx_kind_malloc</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_put_signal.html">shmemx_put_signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_put_signal_nb.html">shmemx_put_signal_nb</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_alltoallv.html">shmemx_alltoallv</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_alltoallv_packed.html">shmemx_alltoallv_packed</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_alltoall.html">shmemx_team_alltoall</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_alltoallv.html">shmemx_team_alltoallv</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_alltoallv_packed.html">shmemx_team_alltoallv_packed</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_barrier.html">shmemx_team_barrier</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_destroy.html">shmemx_team_destroy</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_my_pe.html">shmemx_team_my_pe</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_n_pes.html">shmemx_team_n_pes</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_reductions.html">shmemx_team_reductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_split_2d.html">shmemx_team_split_2d</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_split_3d.html">shmemx_team_split_3d</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_split_color.html">shmemx_team_split_color</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_split_strided.html">shmemx_team_split_strided</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_team_translate_pe.html">shmemx_team_translate_pe</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_thread_fence.html">shmemx_thread_fence</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_thread_quiet.html">shmemx_thread_quiet</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_thread_register.html">shmemx_thread_register</a></li>
<li class="toctree-l1"><a class="reference internal" href="shmemx_thread_unregister.html">shmemx_thread_unregister</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cray OpenSHMEMX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Managing Memory in Cray OpenSHMEMX</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/shmem_mem_manage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="managing-memory-in-cray-openshmemx">
<h1>Managing Memory in Cray OpenSHMEMX<a class="headerlink" href="#managing-memory-in-cray-openshmemx" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">A</span> <span class="n">subset</span> <span class="n">of</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">environment</span> <span class="n">variables</span> <span class="n">deal</span> <span class="n">specifically</span> <span class="k">with</span> <span class="n">how</span>
 <span class="n">memory</span> <span class="ow">is</span> <span class="n">allocated</span> <span class="k">for</span> <span class="n">use</span> <span class="n">by</span> <span class="n">SHMEM</span> <span class="n">routines</span><span class="o">.</span> <span class="n">This</span> <span class="n">section</span> <span class="n">describes</span>
 <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">these</span> <span class="n">environment</span> <span class="n">variables</span><span class="o">.</span>

 <span class="o">**</span><span class="n">The</span> <span class="n">support</span> <span class="k">for</span> <span class="n">this</span> <span class="n">environment</span> <span class="n">variable</span> <span class="ow">is</span> <span class="n">available</span> <span class="n">only</span> <span class="n">on</span> <span class="n">x86_64</span>
 <span class="n">based</span> <span class="n">Cray</span> <span class="n">systems</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">on</span> <span class="n">Aarch64</span> <span class="n">systems</span><span class="o">.**</span>

 <span class="n">SHMEM</span> <span class="n">classifies</span> <span class="n">data</span> <span class="n">objects</span> <span class="k">as</span> <span class="n">either</span> <span class="n">local</span> <span class="ow">or</span> <span class="n">remote</span><span class="p">,</span> <span class="n">based</span> <span class="n">on</span>
 <span class="n">whether</span> <span class="n">the</span> <span class="n">data</span> <span class="nb">object</span> <span class="n">being</span> <span class="n">referenced</span> <span class="ow">is</span> <span class="n">owned</span> <span class="n">by</span> <span class="n">the</span> <span class="n">PE</span> <span class="p">(</span><span class="n">that</span> <span class="ow">is</span><span class="p">,</span>
 <span class="n">local</span> <span class="n">to</span> <span class="n">the</span> <span class="n">PE</span><span class="p">)</span> <span class="ow">or</span> <span class="n">owned</span> <span class="n">by</span> <span class="n">another</span> <span class="n">PE</span> <span class="p">(</span><span class="n">that</span> <span class="ow">is</span><span class="p">,</span> <span class="n">remote</span> <span class="n">to</span> <span class="n">the</span> <span class="n">PE</span><span class="p">)</span><span class="o">.</span>
 <span class="n">It</span> <span class="n">also</span> <span class="n">classifies</span> <span class="n">data</span> <span class="n">objects</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">which</span>
 <span class="n">the</span> <span class="nb">object</span> <span class="n">resides</span><span class="p">:</span> <span class="n">either</span> <span class="n">the</span> <span class="n">data</span> <span class="n">segment</span><span class="p">,</span> <span class="n">the</span> <span class="n">private</span> <span class="n">heap</span><span class="p">,</span> <span class="n">the</span>
 <span class="n">symmetric</span> <span class="n">heap</span><span class="p">,</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">stack</span><span class="o">.</span> <span class="n">As</span> <span class="n">arguments</span> <span class="n">to</span> <span class="n">SHMEM</span> <span class="n">routines</span><span class="p">,</span> <span class="n">local</span>
 <span class="n">objects</span> <span class="n">must</span> <span class="n">reside</span> <span class="n">entirely</span> <span class="n">within</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">four</span> <span class="n">memory</span> <span class="n">regions</span><span class="p">,</span>
 <span class="k">while</span> <span class="n">remote</span> <span class="n">objects</span> <span class="n">must</span> <span class="n">reside</span> <span class="n">entirely</span> <span class="n">within</span> <span class="n">either</span> <span class="n">the</span> <span class="n">data</span>
 <span class="n">segment</span> <span class="ow">or</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="o">.</span>

 <span class="n">To</span> <span class="n">examine</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">usage</span><span class="p">,</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">SHMEM_MEMINFO_DISPLAY</span>
 <span class="n">environment</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">a</span> <span class="n">value</span> <span class="n">of</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">greater</span><span class="o">.</span> <span class="n">Doing</span> <span class="n">so</span> <span class="n">causes</span> <span class="n">SHMEM</span>
 <span class="n">initialization</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">messages</span> <span class="n">similar</span> <span class="n">to</span> <span class="n">this</span> <span class="n">example</span><span class="o">.</span>

    <span class="n">LIBSMA</span> <span class="n">INFO</span><span class="p">:</span>
     <span class="nb">min</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span>           <span class="o">-</span> <span class="mi">24</span>           <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span>           <span class="o">-</span> <span class="mi">24</span>           <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">min</span> <span class="n">nominal</span> <span class="n">node</span> <span class="n">size</span>      <span class="o">-</span> <span class="mi">32768</span><span class="n">M</span> <span class="o">-</span> <span class="mi">32</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">nominal</span> <span class="n">node</span> <span class="n">size</span>      <span class="o">-</span> <span class="mi">32768</span><span class="n">M</span> <span class="o">-</span> <span class="mi">32</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">min</span> <span class="n">boot_freemem</span>           <span class="o">-</span> <span class="mi">32032</span><span class="n">M</span> <span class="o">-</span> <span class="mi">31</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">65</span>
     <span class="nb">max</span> <span class="n">boot_freemem</span>           <span class="o">-</span> <span class="mi">32035</span><span class="n">M</span> <span class="o">-</span> <span class="mi">31</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">56</span>
     <span class="nb">min</span> <span class="n">initial_freemem</span>        <span class="o">-</span> <span class="mi">31783</span><span class="n">M</span> <span class="o">-</span> <span class="mi">31</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">initial_freemem</span>        <span class="o">-</span> <span class="mi">31791</span><span class="n">M</span> <span class="o">-</span> <span class="mi">31</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">7</span>
     <span class="nb">min</span> <span class="n">current_freemem</span>        <span class="o">-</span>  <span class="mi">7532</span><span class="n">M</span> <span class="o">-</span>  <span class="mi">7</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">current_freemem</span>        <span class="o">-</span>  <span class="mi">7539</span><span class="n">M</span> <span class="o">-</span>  <span class="mi">7</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">7</span>
     <span class="n">huge</span> <span class="n">page</span> <span class="n">size</span>             <span class="o">-</span>  <span class="mi">2048</span><span class="n">K</span>
     <span class="n">huge</span> <span class="n">pages</span> <span class="n">reserved</span> <span class="o">-</span><span class="mi">12000</span> <span class="o">-</span> <span class="mi">24000</span><span class="n">M</span> <span class="o">-</span> <span class="mi">23</span><span class="n">G</span>
     <span class="nb">min</span> <span class="n">huge_page_freemem</span>      <span class="o">-</span>  <span class="mi">6416</span><span class="n">M</span> <span class="o">-</span>  <span class="mi">6</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">huge_page_freemem</span>      <span class="o">-</span>  <span class="mi">6708</span><span class="n">M</span> <span class="o">-</span>  <span class="mi">6</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">6</span>
     <span class="nb">min</span> <span class="n">huge</span> <span class="n">pages</span> <span class="n">alloc</span><span class="o">-</span><span class="mi">12125</span> <span class="o">-</span> <span class="mi">24250</span><span class="n">M</span> <span class="o">-</span> <span class="mi">23</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="nb">max</span> <span class="n">huge</span> <span class="n">pages</span> <span class="n">alloc</span><span class="o">-</span><span class="mi">12125</span> <span class="o">-</span> <span class="mi">24250</span><span class="n">M</span> <span class="o">-</span> <span class="mi">23</span><span class="n">G</span> <span class="n">on</span> <span class="n">nid</span> <span class="mi">62</span>
     <span class="o">-----------------------------------------------------------</span>
     <span class="n">memory</span>                                   <span class="n">size</span> <span class="p">(</span><span class="n">decimal</span> <span class="n">MiB</span><span class="p">)</span>
     <span class="n">region</span>   <span class="n">virtual</span> <span class="n">address</span> <span class="nb">range</span>           <span class="n">per</span> <span class="n">proc</span>  <span class="n">per</span> <span class="n">node</span>
     <span class="o">-------</span>  <span class="o">------------------------------</span>  <span class="o">--------</span>  <span class="o">--------</span>
     <span class="n">text</span>     <span class="mh">0x000000400000</span><span class="o">..</span><span class="mh">0x000000501fe8</span>        <span class="mi">1</span><span class="n">M</span>       <span class="mi">24</span><span class="n">M</span>
     <span class="n">data</span>     <span class="mh">0x000000703000</span><span class="o">..</span><span class="mh">0x000000745b68</span>        <span class="mi">0</span><span class="n">M</span>        <span class="mi">6</span><span class="n">M</span>
     <span class="n">bss</span>      <span class="mh">0x000000745b68</span><span class="o">..</span><span class="mh">0x000006b6d190</span>      <span class="mi">100</span><span class="n">M</span>     <span class="mi">2403</span><span class="n">M</span>
     <span class="n">privheap</span> <span class="mh">0x000006b6d190</span><span class="o">..</span><span class="mh">0x000006b90000</span>        <span class="mi">0</span><span class="n">M</span>        <span class="mi">3</span><span class="n">M</span>
     <span class="n">symheap</span>  <span class="mh">0x030000000000</span><span class="o">..</span><span class="mh">0x030038400000</span>      <span class="mi">900</span><span class="n">M</span>    <span class="mi">21600</span><span class="n">M</span>
     <span class="n">alltoall</span> <span class="mh">0x0300384fda40</span><span class="o">..</span><span class="mh">0x0300388fda40</span>        <span class="mi">4</span><span class="n">M</span>       <span class="mi">96</span><span class="n">M</span>
     <span class="n">team</span>     <span class="mh">0x0300388fdac0</span><span class="o">..</span><span class="mh">0x0300388fdca0</span>        <span class="mi">0</span><span class="n">M</span>        <span class="mi">0</span><span class="n">M</span>
     <span class="n">stack</span>    <span class="mh">0x7ffffffe8000</span><span class="o">..</span><span class="mh">0x7ffffffff000</span>        <span class="mi">0</span><span class="n">M</span>        <span class="mi">2</span><span class="n">M</span>
     <span class="o">--</span><span class="n">total</span>                                     <span class="mi">1005</span><span class="n">M</span>    <span class="mi">24134</span><span class="n">M</span>
     <span class="n">OS</span>                                                     <span class="mi">735</span><span class="n">M</span>
     <span class="o">--</span><span class="n">total</span>                                              <span class="mi">24869</span><span class="n">M</span> <span class="o">-</span> <span class="mi">24</span><span class="n">G</span>


<span class="n">Understanding</span> <span class="n">the</span> <span class="n">LIBSMA</span> <span class="n">INFO</span>

  <span class="n">nominal</span> <span class="n">node</span> <span class="n">size</span>
            <span class="n">The</span> <span class="n">nominal</span> <span class="n">node</span> <span class="n">size</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">total</span> <span class="n">physical</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span>
            <span class="n">node</span><span class="p">,</span> <span class="n">rounded</span> <span class="n">to</span> <span class="n">the</span> <span class="n">nearest</span> <span class="n">GiB</span><span class="o">.</span> <span class="n">Since</span> <span class="n">different</span> <span class="n">compute</span>
            <span class="n">notes</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">system</span> <span class="n">may</span> <span class="n">have</span> <span class="n">different</span> <span class="n">amounts</span> <span class="n">of</span> <span class="n">physical</span>
            <span class="n">memory</span><span class="p">,</span> <span class="n">the</span> <span class="n">minimum</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="n">sizes</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">nodes</span>
            <span class="n">allocated</span> <span class="n">to</span> <span class="n">your</span> <span class="n">job</span> <span class="n">are</span> <span class="n">shown</span><span class="o">.</span> <span class="n">If</span> <span class="n">these</span> <span class="n">values</span> <span class="n">differ</span> <span class="kn">from</span>
            <span class="nn">what</span> <span class="n">you</span> <span class="n">expected</span><span class="p">,</span> <span class="n">examine</span> <span class="n">your</span> <span class="n">job</span> <span class="n">submission</span> <span class="n">resource</span>
            <span class="n">settings</span><span class="o">.</span>

  <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span>
            <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">active</span> <span class="n">number</span> <span class="n">of</span> <span class="n">processes</span>
            <span class="n">allocated</span> <span class="n">to</span> <span class="n">the</span> <span class="n">node</span><span class="p">,</span> <span class="ow">not</span> <span class="n">necessarily</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span>
            <span class="n">physical</span> <span class="n">cores</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span><span class="o">.</span> <span class="n">Variations</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span>
            <span class="n">per</span> <span class="n">node</span> <span class="n">normally</span> <span class="n">indicate</span> <span class="n">that</span> <span class="n">the</span> <span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span>
            <span class="n">allocated</span> <span class="k">for</span> <span class="n">the</span> <span class="n">job</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">multiple</span> <span class="n">of</span> <span class="n">the</span>
            <span class="n">requested</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span><span class="p">,</span> <span class="n">so</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span>
            <span class="n">node</span> <span class="k">with</span> <span class="n">a</span> <span class="n">smaller</span> <span class="n">number</span> <span class="n">of</span> <span class="n">active</span> <span class="n">PEs</span><span class="p">,</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">heterogeneous</span>
            <span class="nb">set</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">may</span> <span class="n">have</span> <span class="n">been</span> <span class="n">allocated</span> <span class="n">to</span> <span class="n">the</span> <span class="n">job</span> <span class="n">where</span> <span class="n">some</span>
            <span class="n">nodes</span> <span class="n">have</span> <span class="n">fewer</span> <span class="n">cores</span> <span class="n">than</span> <span class="n">others</span><span class="o">.</span> <span class="n">This</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">cause</span> <span class="n">a</span>
            <span class="n">problem</span> <span class="k">for</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">allocation</span> <span class="n">because</span> <span class="n">fewer</span> <span class="n">PEs</span> <span class="n">per</span>
            <span class="n">node</span> <span class="n">means</span> <span class="n">more</span><span class="p">,</span> <span class="ow">not</span> <span class="n">less</span><span class="p">,</span> <span class="n">memory</span> <span class="ow">is</span> <span class="n">available</span> <span class="n">to</span> <span class="n">each</span> <span class="n">of</span>
            <span class="n">those</span> <span class="n">PEs</span><span class="o">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">allocated</span> <span class="n">regions</span> <span class="ow">is</span> <span class="n">still</span> <span class="n">the</span>
            <span class="n">same</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">PEs</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">job</span><span class="p">,</span> <span class="n">but</span> <span class="ow">is</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">the</span>
            <span class="n">minimum</span> <span class="n">available</span> <span class="n">memory</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">PEs</span><span class="o">.</span>

 <span class="n">boot_freemem</span>
           <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">kernel</span><span class="o">-</span><span class="n">determined</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span>
           <span class="n">available</span> <span class="n">to</span> <span class="n">programs</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span> <span class="n">at</span> <span class="n">boot</span> <span class="n">time</span><span class="p">,</span> <span class="n">before</span> <span class="nb">any</span>
           <span class="n">programs</span> <span class="n">have</span> <span class="n">run</span><span class="o">.</span> <span class="n">This</span> <span class="n">value</span> <span class="n">remains</span> <span class="n">unchanged</span> <span class="k">while</span> <span class="n">the</span>
           <span class="n">system</span> <span class="ow">is</span> <span class="n">running</span><span class="o">.</span> <span class="n">The</span> <span class="n">value</span> <span class="n">will</span> <span class="n">vary</span> <span class="n">at</span> <span class="n">least</span> <span class="n">slightly</span>
           <span class="kn">from</span> <span class="nn">node</span> <span class="n">to</span> <span class="n">node</span><span class="o">.</span> <span class="n">Large</span> <span class="n">variations</span> <span class="n">between</span> <span class="n">the</span> <span class="n">minimum</span> <span class="ow">and</span>
           <span class="n">maximum</span> <span class="n">value</span> <span class="n">may</span> <span class="n">indicate</span> <span class="n">a</span> <span class="n">problem</span><span class="o">.</span>

 <span class="n">initial_freemem</span>
           <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">kernel</span><span class="o">-</span><span class="n">determined</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span>
           <span class="n">that</span> <span class="n">was</span> <span class="n">free</span> <span class="n">at</span> <span class="n">the</span> <span class="n">beginning</span> <span class="n">of</span> <span class="n">the</span> <span class="n">startup</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current</span>
           <span class="n">job</span><span class="o">.</span> <span class="n">The</span> <span class="n">difference</span> <span class="n">between</span> <span class="n">boot_freemem</span> <span class="ow">and</span> <span class="n">initial_freemem</span>
           <span class="ow">is</span> <span class="n">a</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">how</span> <span class="n">much</span> <span class="n">memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span> <span class="n">to</span> <span class="n">the</span>
           <span class="n">application</span><span class="p">,</span> <span class="n">either</span> <span class="n">because</span> <span class="n">of</span> <span class="n">processes</span> <span class="kn">from</span> <span class="nn">previous</span> <span class="n">jobs</span>
           <span class="n">that</span> <span class="k">for</span> <span class="n">some</span> <span class="n">reason</span> <span class="n">are</span> <span class="n">still</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span> <span class="ow">or</span>
           <span class="n">possibly</span> <span class="n">because</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">leaks</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span><span class="o">.</span> <span class="n">A</span> <span class="n">qualifier</span> <span class="n">to</span>
           <span class="n">this</span> <span class="ow">is</span> <span class="n">that</span> <span class="kn">from</span> <span class="nn">job</span> <span class="n">run</span> <span class="n">to</span> <span class="n">job</span> <span class="n">run</span><span class="p">,</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">may</span> <span class="n">be</span>
           <span class="n">temporarily</span> <span class="n">holding</span> <span class="n">onto</span> <span class="n">some</span> <span class="n">memory</span> <span class="n">that</span> <span class="n">it</span> <span class="n">may</span> <span class="n">later</span> <span class="n">free</span>
           <span class="k">while</span> <span class="n">the</span> <span class="n">job</span> <span class="ow">is</span> <span class="n">running</span><span class="o">.</span> <span class="n">Significant</span> <span class="n">differences</span> <span class="p">(</span><span class="mi">1</span> <span class="n">GB</span> <span class="ow">or</span>
           <span class="n">more</span><span class="p">)</span> <span class="n">probably</span> <span class="n">indicate</span> <span class="n">a</span> <span class="n">serious</span> <span class="n">problem</span> <span class="n">on</span> <span class="n">that</span> <span class="n">node</span><span class="o">.</span>

 <span class="n">current_freemem</span>
           <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">that</span> <span class="n">was</span> <span class="n">free</span> <span class="n">at</span>
           <span class="n">the</span> <span class="n">completion</span> <span class="n">of</span> <span class="n">SHMEM</span> <span class="n">initialization</span><span class="o">.</span> <span class="n">This</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">based</span>
           <span class="n">on</span> <span class="n">the</span> <span class="n">kernel</span><span class="o">-</span><span class="n">determined</span> <span class="n">value</span> <span class="n">of</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">current_freemem</span> <span class="n">at</span>
           <span class="n">that</span> <span class="n">time</span> <span class="n">plus</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">already</span> <span class="n">allocated</span> <span class="k">for</span>
           <span class="n">text</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bss</span><span class="p">,</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="p">,</span> <span class="n">private</span> <span class="n">heap</span><span class="p">,</span> <span class="ow">and</span> <span class="n">stack</span><span class="o">.</span>
           <span class="n">Memory</span> <span class="n">reserved</span> <span class="p">(</span><span class="n">by</span> <span class="n">the</span> <span class="n">aprun</span> <span class="o">-</span><span class="n">m</span> <span class="n">option</span><span class="p">)</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">allocated</span>
           <span class="k">for</span> <span class="nb">any</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">memory</span> <span class="n">regions</span> <span class="ow">is</span> <span class="n">still</span> <span class="n">considered</span> <span class="n">free</span>
           <span class="ow">and</span> <span class="ow">is</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">current_freemem</span> <span class="n">value</span><span class="o">.</span> <span class="n">This</span> <span class="n">memory</span> <span class="ow">is</span>
           <span class="n">available</span> <span class="k">for</span> <span class="n">use</span> <span class="n">later</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">application</span> <span class="k">for</span> <span class="n">growing</span> <span class="n">of</span>
           <span class="n">the</span> <span class="n">private</span> <span class="n">heap</span> <span class="ow">or</span> <span class="k">for</span> <span class="n">stack</span> <span class="n">variables</span><span class="o">.</span> <span class="n">The</span> <span class="n">value</span> <span class="n">can</span> <span class="n">be</span>
           <span class="n">expected</span> <span class="n">to</span> <span class="n">vary</span> <span class="n">slightly</span> <span class="kn">from</span> <span class="nn">node</span> <span class="n">to</span> <span class="n">node</span><span class="o">.</span>

 <span class="n">huge_page_size</span>
           <span class="n">The</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">huge</span> <span class="n">pages</span> <span class="k">for</span> <span class="n">those</span> <span class="n">memory</span> <span class="n">regions</span>
           <span class="n">backed</span> <span class="n">by</span> <span class="n">huge</span> <span class="n">pages</span><span class="o">.</span>

 <span class="n">huge_pages_reserved</span>
           <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">huge</span> <span class="n">pages</span> <span class="n">reserved</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">bytes</span> <span class="n">of</span>
           <span class="n">the</span> <span class="n">memory</span> <span class="n">backed</span> <span class="n">by</span> <span class="n">huge</span> <span class="n">pages</span><span class="o">.</span> <span class="n">The</span> <span class="n">usual</span> <span class="n">method</span> <span class="k">for</span>
           <span class="n">reserving</span> <span class="n">huge</span> <span class="n">pages</span> <span class="ow">is</span> <span class="n">by</span> <span class="n">using</span> <span class="n">the</span> <span class="n">aprun</span> <span class="o">-</span><span class="n">m</span> <span class="n">size</span> <span class="p">[</span><span class="n">h</span><span class="o">|</span><span class="n">hs</span><span class="p">]</span>
           <span class="n">parameter</span><span class="o">.</span> <span class="n">See</span> <span class="n">the</span> <span class="n">aprun</span> <span class="n">man</span> <span class="n">page</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>

 <span class="n">huge_page_freemem</span>
           <span class="n">This</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">free</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">large</span><span class="o">-</span><span class="n">enough</span>
           <span class="n">blocks</span> <span class="n">to</span> <span class="n">support</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">huge</span> <span class="n">pages</span><span class="o">.</span> <span class="n">This</span> <span class="n">value</span>
           <span class="n">takes</span> <span class="n">into</span> <span class="n">account</span> <span class="n">that</span> <span class="n">memory</span> <span class="n">can</span> <span class="n">get</span> <span class="n">fragmented</span> <span class="ow">and</span> <span class="n">that</span>
           <span class="n">the</span> <span class="n">total</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">free</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">large</span><span class="o">-</span><span class="n">enough</span> <span class="n">blocks</span> <span class="n">may</span>
           <span class="n">be</span> <span class="n">less</span> <span class="n">than</span> <span class="n">the</span> <span class="n">total</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">free</span> <span class="n">memory</span><span class="o">.</span> <span class="n">This</span> <span class="n">value</span>
           <span class="n">includes</span> <span class="n">huge</span> <span class="n">pages</span> <span class="n">that</span> <span class="n">have</span> <span class="n">been</span> <span class="n">reserved</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">yet</span>
           <span class="n">allocated</span><span class="p">,</span> <span class="n">so</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">critical</span> <span class="n">value</span> <span class="k">for</span> <span class="n">determining</span> <span class="n">how</span>
           <span class="n">many</span> <span class="n">huge</span> <span class="n">pages</span> <span class="n">can</span> <span class="n">be</span> <span class="n">allocated</span><span class="o">.</span> <span class="n">The</span> <span class="n">difference</span> <span class="n">between</span>
           <span class="n">current_freemem</span> <span class="ow">and</span> <span class="n">huge_pages_freemem</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">how</span>
           <span class="n">much</span> <span class="n">memory</span> <span class="ow">is</span> <span class="n">fragmented</span><span class="o">.</span>

 <span class="n">huge_pages_alloc</span>
           <span class="n">This</span> <span class="n">gives</span> <span class="n">the</span> <span class="n">values</span> <span class="n">of</span> <span class="n">both</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">huge</span> <span class="n">pages</span>
           <span class="n">allocated</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">corresponding</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="ow">in</span> <span class="nb">bytes</span>
           <span class="p">(</span><span class="n">actually</span><span class="p">,</span> <span class="ow">in</span> <span class="n">mebibytes</span><span class="p">)</span><span class="o">.</span> <span class="n">Pages</span> <span class="n">may</span> <span class="n">have</span> <span class="n">been</span> <span class="n">reserved</span> <span class="n">but</span>
           <span class="ow">not</span> <span class="n">yet</span> <span class="n">allocated</span><span class="p">,</span> <span class="ow">and</span> <span class="n">because</span> <span class="n">CLE</span> <span class="n">supports</span> <span class="n">dynamic</span>
           <span class="n">allocation</span> <span class="n">of</span> <span class="n">huge</span> <span class="n">pages</span><span class="p">,</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">allocated</span> <span class="n">may</span> <span class="n">be</span> <span class="n">more</span>
           <span class="n">than</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">reserved</span><span class="o">.</span>

           <span class="n">Note</span> <span class="n">that</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">backed</span> <span class="n">by</span> <span class="n">huge</span>
           <span class="n">pages</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">full</span> <span class="n">XT_SYMMETRIC_HEAP_SIZE</span> <span class="n">amount</span> <span class="ow">is</span>
           <span class="n">considered</span> <span class="n">allocated</span> <span class="n">during</span> <span class="n">SHMEM</span> <span class="n">initialization</span><span class="o">.</span> <span class="n">Therefore</span>
           <span class="n">memory</span> <span class="n">allocated</span> <span class="k">for</span> <span class="n">the</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">longer</span> <span class="n">free</span> <span class="ow">in</span>
           <span class="n">the</span> <span class="n">context</span> <span class="n">of</span> <span class="n">current_freemem</span> <span class="ow">or</span> <span class="n">huge_page_freemem</span><span class="p">,</span> <span class="n">but</span> <span class="ow">is</span>
           <span class="n">only</span> <span class="n">available</span> <span class="n">through</span> <span class="n">shmalloc</span><span class="p">()</span> <span class="n">calls</span><span class="o">.</span>

 <span class="n">A</span> <span class="n">percentage</span> <span class="p">(</span><span class="n">controlled</span> <span class="n">by</span> <span class="n">the</span> <span class="n">SHMEM_FREEMEM_THRESHOLD</span> <span class="n">environment</span>
 <span class="n">variable</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current_freemem</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">displayed</span> <span class="n">because</span> <span class="n">the</span> <span class="n">value</span>
 <span class="n">at</span> <span class="n">the</span> <span class="n">time</span> <span class="n">of</span> <span class="n">SHMEM</span> <span class="n">initialization</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">reflect</span> <span class="n">future</span> <span class="n">growth</span> <span class="n">of</span>
 <span class="n">the</span> <span class="n">heap</span> <span class="ow">or</span> <span class="n">stack</span> <span class="n">during</span> <span class="n">program</span> <span class="n">execution</span> <span class="ow">and</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">way</span> <span class="k">for</span>
 <span class="n">SHMEM</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">future</span> <span class="n">growth</span><span class="o">.</span> <span class="n">Therefore</span> <span class="n">when</span> <span class="n">initialization</span> <span class="n">tries</span>
 <span class="n">to</span> <span class="n">determine</span> <span class="k">if</span> <span class="n">the</span> <span class="n">program</span> <span class="n">will</span> <span class="n">oversubscribe</span> <span class="n">memory</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">up</span> <span class="n">the</span>
 <span class="n">sizes</span> <span class="n">of</span> <span class="n">the</span> <span class="n">four</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span><span class="p">,</span> <span class="n">allowing</span> <span class="n">allocation</span> <span class="n">of</span> <span class="mi">100</span><span class="o">%</span> <span class="n">of</span>
 <span class="n">the</span> <span class="n">current</span> <span class="n">available</span> <span class="n">memory</span> <span class="n">at</span> <span class="n">this</span> <span class="n">time</span> <span class="n">would</span> <span class="n">very</span> <span class="n">likely</span> <span class="n">lead</span> <span class="n">to</span>
 <span class="n">running</span> <span class="n">out</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">later</span> <span class="n">during</span> <span class="n">execution</span><span class="o">.</span>

 <span class="n">Instead</span><span class="p">,</span> <span class="n">SHMEM</span> <span class="n">allows</span> <span class="n">allocation</span> <span class="n">of</span> <span class="n">a</span> <span class="n">percentage</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">using</span> <span class="n">the</span>
 <span class="n">SHMEM_FREEMEM_THRESHOLD</span> <span class="n">environment</span> <span class="n">variable</span><span class="o">.</span> <span class="n">On</span> <span class="n">subsequent</span> <span class="n">job</span>
 <span class="n">launches</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">increase</span> <span class="ow">or</span> <span class="n">decreased</span> <span class="n">this</span> <span class="n">value</span> <span class="n">based</span> <span class="n">on</span> <span class="n">your</span>
 <span class="n">knowledge</span> <span class="n">of</span> <span class="n">the</span> <span class="n">program</span> <span class="ow">and</span> <span class="n">experience</span> <span class="n">running</span> <span class="n">it</span><span class="o">.</span> <span class="n">Since</span> <span class="n">each</span> <span class="n">node</span>
 <span class="n">allocated</span> <span class="n">to</span> <span class="n">a</span> <span class="n">job</span> <span class="n">runs</span> <span class="n">its</span> <span class="n">own</span> <span class="n">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">operating</span> <span class="n">system</span><span class="p">,</span>
 <span class="n">since</span> <span class="n">each</span> <span class="n">node</span> <span class="n">may</span> <span class="n">have</span> <span class="n">different</span> <span class="n">amounts</span> <span class="n">of</span> <span class="n">physical</span> <span class="n">memory</span><span class="p">,</span> <span class="ow">and</span>
 <span class="n">since</span> <span class="n">Linux</span> <span class="n">memory</span> <span class="n">management</span> <span class="ow">is</span> <span class="n">highly</span> <span class="n">dynamic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strictly</span>
 <span class="n">deterministic</span><span class="p">,</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">available</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span> <span class="n">can</span> <span class="n">vary</span>
 <span class="n">slightly</span> <span class="kn">from</span> <span class="nn">node</span> <span class="n">to</span> <span class="n">node</span><span class="p">,</span> <span class="ow">or</span> <span class="n">sometimes</span> <span class="n">greatly</span><span class="o">.</span> <span class="n">Given</span> <span class="n">that</span> <span class="n">the</span> <span class="n">SHMEM</span>
 <span class="n">programming</span> <span class="n">model</span> <span class="n">requires</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">regions</span> <span class="n">to</span> <span class="n">be</span> <span class="n">the</span>
 <span class="n">same</span> <span class="k">for</span> <span class="n">each</span> <span class="n">PE</span><span class="p">,</span> <span class="n">a</span> <span class="n">variation</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">available</span> <span class="n">memory</span> <span class="kn">from</span> <span class="nn">node</span> <span class="n">to</span>
 <span class="n">node</span> <span class="n">means</span> <span class="n">that</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="n">essentially</span> <span class="nb">all</span> <span class="n">that</span>
 <span class="ow">is</span> <span class="n">available</span> <span class="n">per</span> <span class="n">node</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">PEs</span><span class="o">.</span>

 <span class="n">The</span> <span class="n">lower</span> <span class="n">section</span> <span class="n">of</span> <span class="n">the</span> <span class="n">message</span> <span class="n">lines</span> <span class="n">displays</span> <span class="n">the</span> <span class="n">virtual</span> <span class="n">address</span>
 <span class="n">ranges</span> <span class="k">for</span> <span class="n">the</span> <span class="n">four</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span><span class="o">.</span> <span class="n">Addresses</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">some</span> <span class="n">cases</span>
 <span class="n">rounded</span> <span class="n">to</span> <span class="n">meet</span> <span class="n">alignment</span> <span class="n">requirements</span><span class="o">.</span>

 <span class="n">text</span>      <span class="n">The</span> <span class="n">text</span> <span class="n">segment</span> <span class="ow">is</span> <span class="ow">not</span><span class="p">,</span> <span class="n">strictly</span> <span class="n">speaking</span><span class="p">,</span> <span class="n">a</span> <span class="n">SHMEM</span> <span class="n">memory</span>
           <span class="n">region</span><span class="p">,</span> <span class="n">but</span> <span class="ow">is</span> <span class="n">displayed</span> <span class="n">here</span> <span class="n">because</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">important</span>
           <span class="n">piece</span> <span class="n">of</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">allocation</span> <span class="n">picture</span><span class="o">.</span> <span class="n">This</span> <span class="n">includes</span>
           <span class="n">executable</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span> <span class="n">data</span><span class="o">.</span>

 <span class="n">data</span>      <span class="n">The</span> <span class="n">initialized</span> <span class="n">read</span><span class="o">/</span><span class="n">write</span> <span class="n">data</span> <span class="n">area</span><span class="o">.</span>

 <span class="n">bss</span>       <span class="n">The</span> <span class="n">uninitialized</span> <span class="n">read</span><span class="o">/</span><span class="n">write</span> <span class="n">data</span> <span class="n">area</span><span class="o">.</span> <span class="n">Taken</span> <span class="n">together</span><span class="p">,</span> <span class="n">the</span>
           <span class="n">data</span> <span class="ow">and</span> <span class="n">bss</span> <span class="n">regions</span> <span class="n">comprise</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">data</span> <span class="n">segment</span><span class="o">.</span>

 <span class="n">privheap</span>  <span class="n">The</span> <span class="n">private</span> <span class="n">heap</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">region</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">used</span> <span class="n">primarily</span> <span class="k">for</span>
           <span class="n">data</span> <span class="n">objects</span> <span class="n">allocated</span> <span class="k">with</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">malloc</span><span class="p">()</span><span class="o">.</span> <span class="n">The</span> <span class="n">private</span>
           <span class="n">heap</span> <span class="n">can</span> <span class="n">grow</span> <span class="k">as</span> <span class="n">more</span> <span class="n">memory</span> <span class="ow">is</span> <span class="n">allocated</span><span class="o">.</span> <span class="n">The</span> <span class="n">value</span>
           <span class="n">displayed</span> <span class="n">by</span> <span class="n">SHMEM</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">at</span> <span class="n">the</span> <span class="n">time</span> <span class="n">that</span> <span class="n">SHMEM</span>
           <span class="n">initialization</span> <span class="ow">is</span> <span class="n">complete</span><span class="p">,</span> <span class="n">so</span> <span class="n">it</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">reflect</span> <span class="nb">any</span>
           <span class="n">growth</span> <span class="n">of</span> <span class="n">the</span> <span class="n">heap</span> <span class="n">later</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">job</span><span class="o">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">application</span>
           <span class="n">mallocs</span> <span class="n">a</span> <span class="n">significant</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span><span class="p">,</span> <span class="n">this</span> <span class="n">should</span> <span class="n">be</span> <span class="n">taken</span>
           <span class="n">into</span> <span class="n">consideration</span> <span class="n">when</span> <span class="n">looking</span> <span class="n">at</span> <span class="n">current_freemem</span> <span class="ow">and</span>
           <span class="n">huge_page_freemem</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">display</span><span class="o">.</span> <span class="n">SHMEM</span> <span class="n">initialization</span>
           <span class="n">can</span> <span class="ow">not</span> <span class="n">know</span> <span class="n">how</span> <span class="n">much</span> <span class="n">the</span> <span class="n">private</span> <span class="n">heap</span> <span class="n">will</span> <span class="n">grow</span><span class="o">.</span>

 <span class="n">symheap</span>   <span class="n">The</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">region</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">SHMEM</span> <span class="n">has</span>
           <span class="n">registered</span> <span class="k">with</span> <span class="n">the</span> <span class="n">network</span> <span class="k">for</span> <span class="n">data</span> <span class="n">transfers</span> <span class="n">of</span> <span class="n">objects</span> <span class="n">on</span>
           <span class="n">the</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="o">.</span> <span class="n">Data</span> <span class="n">objects</span> <span class="n">on</span> <span class="n">the</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="n">are</span>
           <span class="n">allocated</span> <span class="k">for</span> <span class="n">use</span> <span class="n">by</span> <span class="n">the</span> <span class="n">program</span> <span class="k">with</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">shmalloc</span><span class="p">()</span> <span class="ow">or</span>
           <span class="n">shpalloc</span><span class="p">()</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">only</span> <span class="n">valid</span> <span class="n">way</span> <span class="n">to</span> <span class="n">allocate</span> <span class="n">objects</span>
           <span class="kn">from</span> <span class="nn">the</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="o">.</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">XT_SYMMETRIC_HEAP_SIZE</span>
           <span class="n">environment</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">control</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">this</span> <span class="n">region</span><span class="o">.</span>

 <span class="n">alltoall</span>  <span class="n">The</span> <span class="n">region</span> <span class="n">of</span> <span class="n">symmetric</span> <span class="n">memory</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">shmem_alltoall</span>
           <span class="n">routines</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="n">specified</span>
           <span class="n">by</span> <span class="n">XT_SYMMETRIC_HEAP_SIZE</span><span class="o">.</span> <span class="n">See</span> <span class="n">the</span>
           <span class="n">SHMEM_ALLTOALL_SYMBUF_SIZE</span> <span class="n">environment</span> <span class="n">variable</span><span class="o">.</span>

 <span class="n">team</span>      <span class="n">The</span> <span class="n">region</span> <span class="n">of</span> <span class="n">symmetric</span> <span class="n">memory</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">team</span>
           <span class="n">routines</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symmetric</span> <span class="n">heap</span> <span class="n">specified</span>
           <span class="n">by</span> <span class="n">XT_SYMMETRIC_HEAP_SIZE</span><span class="o">.</span>

 <span class="n">stack</span>     <span class="n">The</span> <span class="n">SHMEM</span> <span class="n">stack</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">region</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">used</span> <span class="k">for</span> <span class="n">data</span>
           <span class="n">objects</span> <span class="n">allocated</span> <span class="n">on</span> <span class="n">the</span> <span class="n">stack</span><span class="o">.</span> <span class="n">The</span> <span class="n">stack</span> <span class="n">can</span> <span class="n">grow</span> <span class="k">as</span>
           <span class="n">routines</span> <span class="n">are</span> <span class="n">entered</span> <span class="ow">and</span> <span class="n">stack</span> <span class="n">space</span> <span class="ow">is</span> <span class="n">needed</span><span class="o">.</span> <span class="n">The</span> <span class="n">value</span>
           <span class="n">displayed</span> <span class="n">by</span> <span class="n">SHMEM</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">at</span> <span class="n">the</span> <span class="n">time</span> <span class="n">that</span> <span class="n">SHMEM</span>
           <span class="n">initialization</span> <span class="ow">is</span> <span class="n">complete</span> <span class="n">so</span> <span class="n">it</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">reflect</span> <span class="nb">any</span> <span class="n">growth</span>
           <span class="n">of</span> <span class="n">the</span> <span class="n">stack</span> <span class="n">later</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">job</span><span class="o">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">application</span> <span class="n">uses</span> <span class="n">a</span>
           <span class="n">significant</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">stack</span> <span class="n">space</span><span class="p">,</span> <span class="n">this</span> <span class="n">should</span> <span class="n">be</span> <span class="n">taken</span> <span class="n">into</span>
           <span class="n">consideration</span> <span class="n">when</span> <span class="n">looking</span> <span class="n">at</span> <span class="n">current_freemem</span> <span class="ow">and</span>
           <span class="n">huge_page_freemem</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">display</span><span class="o">.</span> <span class="n">SHMEM</span> <span class="n">initialization</span>
           <span class="n">cannot</span> <span class="n">know</span> <span class="n">how</span> <span class="n">much</span> <span class="n">the</span> <span class="n">stack</span> <span class="n">will</span> <span class="n">grow</span><span class="o">.</span>

 <span class="n">The</span> <span class="n">first</span> <span class="o">--</span><span class="n">total</span> <span class="n">line</span> <span class="n">gives</span> <span class="n">the</span> <span class="nb">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">four</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span>
 <span class="n">plus</span> <span class="n">the</span> <span class="n">text</span> <span class="n">segment</span><span class="o">.</span> <span class="n">It</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">necessarily</span> <span class="n">include</span> <span class="nb">all</span> <span class="n">memory</span> <span class="n">used</span>
 <span class="n">by</span> <span class="n">the</span> <span class="n">program</span> <span class="n">during</span> <span class="n">execution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">program</span><span class="o">.</span> <span class="n">The</span> <span class="n">program</span> <span class="n">may</span> <span class="n">cause</span>
 <span class="n">parts</span> <span class="n">of</span> <span class="n">the</span> <span class="n">stack</span> <span class="ow">or</span> <span class="n">heap</span> <span class="n">to</span> <span class="n">grow</span><span class="o">.</span>

 <span class="n">The</span> <span class="n">size</span> <span class="n">given</span> <span class="k">for</span> <span class="n">the</span> <span class="n">OS</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">estimate</span> <span class="n">based</span> <span class="n">on</span> <span class="n">information</span> <span class="n">provided</span>
 <span class="n">by</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">boot_freemem</span> <span class="n">on</span> <span class="n">CLE</span> <span class="mf">3.0</span> <span class="n">systems</span> <span class="ow">or</span> <span class="n">later</span><span class="o">.</span> <span class="n">This</span> <span class="n">size</span> <span class="n">basically</span>
 <span class="n">represents</span> <span class="nb">all</span> <span class="n">of</span> <span class="n">physical</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span> <span class="ow">not</span> <span class="n">directly</span> <span class="n">available</span>
 <span class="n">to</span> <span class="n">the</span> <span class="n">running</span> <span class="n">program</span><span class="o">.</span>

 <span class="n">The</span> <span class="n">second</span> <span class="o">--</span><span class="n">total</span> <span class="n">line</span> <span class="n">gives</span> <span class="n">the</span> <span class="nb">sum</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">allocated</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span>
 <span class="n">node</span> <span class="n">at</span> <span class="n">the</span> <span class="n">time</span> <span class="n">of</span> <span class="n">SHMEM</span> <span class="n">initialization</span><span class="o">.</span> <span class="n">The</span> <span class="n">purpose</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">give</span> <span class="n">a</span>
 <span class="n">rough</span> <span class="n">idea</span> <span class="n">of</span> <span class="n">how</span> <span class="n">much</span> <span class="n">of</span> <span class="n">the</span> <span class="n">node</span><span class="s1">&#39;s memory is being used and how much</span>
 <span class="n">more</span> <span class="n">could</span> <span class="n">be</span> <span class="n">potentially</span> <span class="n">used</span> <span class="k">if</span> <span class="n">needed</span><span class="o">.</span>

 <span class="n">The</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span> <span class="n">are</span> <span class="n">allocated</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">and</span> <span class="n">every</span> <span class="n">PE</span><span class="o">.</span> <span class="n">If</span> <span class="n">there</span>
 <span class="ow">is</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">active</span> <span class="n">PE</span> <span class="n">per</span> <span class="n">node</span><span class="p">,</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">allocated</span>
 <span class="n">per</span> <span class="n">node</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">per</span> <span class="n">PE</span> <span class="n">value</span> <span class="n">times</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">active</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span><span class="p">,</span>
 <span class="n">so</span> <span class="n">the</span> <span class="n">display</span> <span class="n">shows</span> <span class="n">both</span> <span class="n">on</span> <span class="n">a</span> <span class="n">per</span> <span class="n">process</span> <span class="n">basis</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">per</span> <span class="n">node</span> <span class="n">basis</span><span class="o">.</span>
 <span class="n">The</span> <span class="n">memory</span> <span class="n">allocated</span> <span class="n">to</span> <span class="n">the</span> <span class="n">OS</span> <span class="ow">is</span> <span class="n">only</span> <span class="n">on</span> <span class="n">a</span> <span class="n">per</span> <span class="n">node</span> <span class="n">basis</span><span class="o">.</span>
</pre></div>
</div>
<p>Overcommitment of Memory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Because</span> <span class="n">Cray</span> <span class="n">XE</span> <span class="n">systems</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">swap</span> <span class="n">space</span> <span class="n">that</span> <span class="n">would</span> <span class="n">allow</span>
 <span class="n">overcommitment</span> <span class="n">of</span> <span class="n">physical</span> <span class="n">memory</span><span class="p">,</span> <span class="n">SHMEM</span> <span class="n">initialization</span> <span class="n">attempts</span> <span class="n">to</span>
 <span class="n">detect</span> <span class="n">overcommitment</span><span class="o">.</span> <span class="n">A</span> <span class="n">process</span> <span class="n">cannot</span> <span class="n">request</span> <span class="n">a</span> <span class="n">total</span> <span class="n">amount</span> <span class="n">of</span>
 <span class="n">memory</span> <span class="k">for</span> <span class="n">the</span> <span class="n">combined</span> <span class="n">data</span><span class="p">,</span> <span class="n">private</span> <span class="n">heap</span><span class="p">,</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="p">,</span> <span class="ow">and</span> <span class="n">stack</span>
 <span class="n">segments</span> <span class="ow">in</span> <span class="n">excess</span> <span class="n">of</span> <span class="n">the</span> <span class="n">available</span> <span class="n">free</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span> <span class="n">divided</span> <span class="n">by</span>
 <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">active</span> <span class="n">processes</span> <span class="n">on</span> <span class="n">the</span> <span class="n">node</span><span class="o">.</span>

<span class="n">You</span> <span class="n">will</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">much</span> <span class="n">of</span> <span class="n">the</span> <span class="n">physical</span> <span class="n">memory</span> <span class="n">on</span> <span class="n">the</span>
<span class="n">node</span> <span class="k">as</span> <span class="n">possible</span> <span class="k">for</span> <span class="n">the</span> <span class="n">program</span><span class="s1">&#39;s statically and dynamically</span>
<span class="n">allocated</span> <span class="n">data</span><span class="o">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">total</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">regions</span> <span class="n">per</span> <span class="n">PE</span> <span class="n">times</span>
<span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">active</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span> <span class="n">exceeds</span> <span class="n">the</span> <span class="n">available</span> <span class="n">physical</span>
<span class="n">memory</span><span class="p">,</span> <span class="n">a</span> <span class="n">message</span> <span class="n">like</span> <span class="n">this</span> <span class="n">one</span> <span class="n">displays</span><span class="p">:</span>

   <span class="n">LIBSMA</span> <span class="n">ERROR</span><span class="p">:</span>
    <span class="n">The</span> <span class="n">total</span> <span class="n">requested</span> <span class="n">size</span> <span class="k">for</span> <span class="n">the</span> <span class="n">data</span> <span class="n">segment</span><span class="p">,</span> <span class="n">stack</span><span class="p">,</span>
    <span class="n">SHMEM</span> <span class="n">symmetric</span> <span class="n">heap</span><span class="p">,</span> <span class="ow">and</span> <span class="n">private</span> <span class="n">heap</span> <span class="n">per</span> <span class="n">PE</span> <span class="n">of</span> <span class="mi">1500</span><span class="n">M</span><span class="p">,</span>
    <span class="n">times</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span> <span class="n">of</span> <span class="mi">24</span> <span class="ow">is</span> <span class="mi">36015</span><span class="n">M</span><span class="o">.</span> <span class="n">This</span>
    <span class="n">exceeds</span> <span class="mi">27135</span><span class="n">M</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="mi">95</span><span class="o">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">available</span> <span class="n">memory</span> <span class="n">that</span>
    <span class="ow">is</span> <span class="ow">in</span> <span class="n">blocks</span> <span class="n">large</span> <span class="n">enough</span> <span class="n">to</span> <span class="n">support</span> <span class="n">a</span> <span class="n">page</span> <span class="n">size</span> <span class="n">of</span> <span class="mi">2048</span><span class="n">K</span><span class="o">.</span>
    <span class="n">Try</span> <span class="n">per</span> <span class="n">PE</span> <span class="n">values</span> <span class="k">for</span>
      <span class="n">datasegment</span> <span class="o">+</span> <span class="n">privheap</span> <span class="o">+</span> <span class="n">XT_SYMMETRIC_HEAP_SIZE</span> <span class="o">+</span> <span class="n">stack</span>
    <span class="n">that</span> <span class="n">totals</span> <span class="mi">1130</span><span class="n">M</span> <span class="ow">or</span> <span class="n">less</span><span class="o">.</span>
    <span class="n">Or</span> <span class="n">reduce</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">PEs</span> <span class="n">per</span> <span class="n">node</span><span class="o">.</span>
    <span class="n">Or</span> <span class="k">try</span> <span class="n">a</span> <span class="n">smaller</span> <span class="n">huge</span> <span class="n">page</span> <span class="n">size</span><span class="o">.</span>


<span class="n">The</span> <span class="n">sizes</span> <span class="n">recommended</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">message</span> <span class="n">are</span> <span class="n">guidelines</span><span class="p">,</span> <span class="ow">not</span> <span class="n">guarantees</span><span class="p">,</span>
<span class="n">but</span> <span class="n">are</span> <span class="n">likely</span> <span class="n">to</span> <span class="n">be</span> <span class="n">safe</span><span class="o">.</span> <span class="n">You</span> <span class="n">must</span> <span class="n">match</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">demands</span> <span class="n">of</span> <span class="n">the</span>
<span class="n">program</span> <span class="k">with</span> <span class="n">the</span> <span class="n">physical</span> <span class="n">memory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">sizes</span> <span class="n">of</span> <span class="n">the</span>
<span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span><span class="o">.</span>
</pre></div>
</div>
<p>Out-of-Range Address Arguments</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Data</span> <span class="n">objects</span> <span class="n">that</span> <span class="n">are</span> <span class="n">used</span> <span class="k">as</span> <span class="n">arguments</span> <span class="n">to</span> <span class="n">SHMEM</span> <span class="n">routines</span> <span class="n">must</span> <span class="n">lie</span>
 <span class="n">entirely</span> <span class="n">within</span> <span class="n">the</span> <span class="n">SHMEM</span> <span class="n">memory</span> <span class="n">regions</span><span class="o">.</span> <span class="n">If</span> <span class="n">this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">the</span> <span class="n">case</span><span class="p">,</span> <span class="n">a</span>
 <span class="n">message</span> <span class="n">like</span> <span class="n">this</span> <span class="n">one</span> <span class="ow">is</span> <span class="n">displayed</span><span class="p">:</span>

  <span class="n">LIBSMA</span> <span class="n">ERROR</span><span class="p">:</span> <span class="n">PE</span> <span class="mi">0</span><span class="p">:</span> <span class="n">put</span> <span class="n">target</span> <span class="mh">0x007fffff7fbb50</span> <span class="n">lies</span> <span class="n">neither</span> <span class="ow">in</span> <span class="n">data</span>
     <span class="n">segment</span> <span class="n">nor</span> <span class="n">symmmetric</span> <span class="n">heap</span>
        <span class="n">remote</span> <span class="n">dataseg</span> <span class="p">[</span><span class="mh">0x000000005bc000</span> <span class="o">..</span> <span class="mh">0x0000000063d000</span><span class="p">]</span> <span class="o">-</span> <span class="n">PE</span> <span class="mi">0</span>
        <span class="n">remote</span> <span class="n">symheap</span> <span class="p">[</span><span class="mh">0x002aaaab210000</span> <span class="o">..</span> <span class="mh">0x002aaaac311000</span><span class="p">]</span> <span class="o">-</span> <span class="n">PE</span> <span class="mi">0</span>


<span class="n">In</span> <span class="n">this</span> <span class="n">example</span> <span class="n">the</span> <span class="n">operation</span> <span class="n">failed</span> <span class="n">because</span> <span class="n">the</span> <span class="n">target</span> <span class="n">of</span> <span class="n">a</span> <span class="n">put</span>
<span class="n">operation</span> <span class="n">must</span> <span class="n">be</span> <span class="n">a</span> <span class="n">remote</span> <span class="nb">object</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">clearly</span> <span class="ow">not</span> <span class="ow">in</span>
<span class="n">the</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">either</span> <span class="n">remote</span> <span class="n">memory</span> <span class="n">region</span><span class="o">.</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">need</span> <span class="n">more</span> <span class="n">information</span> <span class="n">to</span> <span class="n">diagnose</span> <span class="ow">and</span> <span class="n">resolve</span> <span class="n">the</span> <span class="n">problem</span> <span class="nb">set</span>
<span class="n">the</span> <span class="n">SHMEM_MEMINFO_DISPLAY</span> <span class="n">environment</span> <span class="n">variable</span> <span class="n">to</span> <span class="n">display</span> <span class="n">information</span>
<span class="n">about</span> <span class="n">how</span> <span class="n">your</span> <span class="n">job</span><span class="s1">&#39;s memory is allocated. For example, doing so would</span>
<span class="n">make</span> <span class="n">it</span> <span class="n">clear</span> <span class="n">that</span> <span class="n">the</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">error</span> <span class="n">message</span> <span class="n">shown</span> <span class="n">above</span> <span class="ow">is</span> <span class="k">for</span>
<span class="n">an</span> <span class="nb">object</span> <span class="n">on</span> <span class="n">the</span> <span class="n">stack</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="k">as</span> <span class="n">the</span> <span class="n">target</span> <span class="k">for</span> <span class="n">a</span> <span class="n">put</span>
<span class="n">operation</span><span class="o">.</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shmem_multithreading.html" class="btn btn-neutral float-right" title="Multithreading in Cray OpenSHMEMX" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro_shmem.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, HPE

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>